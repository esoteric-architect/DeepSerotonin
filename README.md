# DeepSerotonin: Polypharmacological Screening Pipeline

**A graph neural network pipeline for identifying subtype-selective serotonin receptor ligands.**

## Project Context
This project implements the computational drug discovery strategy pioneered by **Gilgamesh Pharmaceuticals**: targeting complex mental health disorders through Neuroplastogens, compounds that induce neuroplasticity without the hallucinogenic effects associated with classic psychedelics.

The engineering challenge is **Selectivity**: identifying molecules that agonize therapeutic targets (e.g., 5-HT1A, 5-HT4, 5-HT6) while avoiding the 5-HT2A receptor (the primary driver of hallucinations) and hERG-related toxicity. This repository contains a trained ensemble of Graph Neural Networks (GIN) capable of predicting binding affinity ($K_i$) across the 5-HT receptor family.

## Methodology

### 1. Model Architecture (Hybrid GNN-LLM)
We model drug-target interaction as a regression task using two modality encoders:
* **Ligand Encoder:** A **Graph Isomorphism Network (GIN)** processes the molecular graph (SMILES â†’ Graph), extracting permutation-invariant structural features.
* **Target Encoder:** The **ESM-2 (35M)** Protein Language Model generates embeddings for the receptor's amino acid sequence. We utilize the mean representation from the 12th attention layer to capture evolutionary structural information.
* **Inference:** A Multi-Layer Perceptron (MLP) fuses these vectors to predict $pK_i$ (Log Binding Affinity).

### 2. Training & Validation
* **Dataset:** BindingDB (filtered for valid $K_i$ values across 5-HT1A, 2A, 2C, 3A, 4, 6, 7).
* **Splitting:** Scaffold Splitting (80/20) was used instead of random splitting. This ensures the test set contains chemical backbones distinct from the training set, measuring the model's ability to generalize to novel structures.
* **Ensemble:** Predictions are averaged across 3 independently trained models to quantify uncertainty and improve robustness.

## Screening Results (2.4M Molecules)

We performed a virtual screen of ~2.4 million molecules from BindingDB. The following candidates represent the most selective hits identified by the model.

### Finding 1: A Highly Selective 5-HT6 Lead
The screen identified a Sulfonamide scaffold with sub-nanomolar affinity for 5-HT6 and negligible affinity for other subtypes. 5-HT6 antagonists are currently investigated for cognitive enhancement in Alzheimer's disease.

**Molecule:** `CNc1nn2c3CCCc3c(C)nc2c1S(=O)(=O)c1ccccc1`

| Target | Predicted $K_i$ (nM) | Specificity Note |
| :--- | :--- | :--- |
| **5-HT6** | **0.60 nM** | **Primary Target** |
| 5-HT1A | > 500 nM | Inactive |
| 5-HT2A | 54.0 nM | Weak / Inactive |
| 5-HT2C | 60.5 nM | Weak / Inactive |

### Finding 2: A Non-Hallucinogenic Anxiolytic Candidate
We identified a Piperazine derivative (Rank #150 in 5-HT1A screen) that selects for the antidepressant target (1A) over the psychedelic target (2A) by a factor of ~1,700x.

**Molecule:** `FCCOc1ccccc1N1CCN(CCN(C(=O)C2CCCCC2)c2ccccn2)CC1`

| Target | Predicted $K_i$ (nM) | Specificity Note |
| :--- | :--- | :--- |
| **5-HT1A** | **0.53 nM** | **High Potency (Anxiolytic)** |
| 5-HT2A | 938.5 nM | Inactive (Non-Hallucinogenic) |
| 5-HT2C | 724.2 nM | Inactive (Low Side-Effect Risk) |

### Finding 3: Validation on Controls
Retrospective profiling of **LSD** correctly predicted potent, broad-spectrum affinity across 5-HT2A (0.4 nM), 5-HT1A, and 5-HT6, consistent with its known "dirty drug" profile.

## Repository Structure

* `datasets/`: CSV files containing the top 1,000 hits for each receptor from the BindingDB screen.
* `models/`: Pre-trained PyTorch weights for the GIN-Ensemble.
* `scripts/`:
    * `train.py`: Training loop with scaffold splitting logic.
    * `model.py`: PyTorch Geometric implementation of the GIN+ESM architecture.
    * `screen_db.py`: High-throughput inference script for massive datasets.
    * `profiler.py`: Tool to generate selectivity bar charts for individual SMILES.

## Usage

**1. Environment Setup**
```bash
pip install -r requirements.txt
```
**2. Selectivity Profiling To predict the binding profile of a specific molecule:**
```bash
python scripts/profiler.py "YOUR_SMILES_STRING"
```
**3. Database Screening To run the model against a custom dataset of SMILES strings:**
```
python scripts/screen_db.py --input data.tsv --output results/
```
## Disclaimer
Research Use Only. The data presented in this repository consists of computational predictions generated by a deep learning model. 
These compounds have not been validated in vitro or in vivo. This project is intended for educational purposes in the field of cheminformatics and computational biology.

